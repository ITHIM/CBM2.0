rm(list=ls())
setwd("~/1.CEDAR/3_Studies !!/23-CBM2/3-Code")
source('AggScenarios6.R')
library(dplyr)
library(stringr)
library(data.table)
library(sqldf)
#library(tcltk)
library(tcltk2)
setwd("V:/Studies/MOVED/HealthImpact/CBM2/Code/Scenarios2012_England") #source folder
todos<-list.files(pattern="[0-9].csv")
todos <-c('baseline.csv',todos)
nfiles <-length(todos)
############   CALCULATE from BASELINE: Individuals
bl <- read.csv('baseline.csv')
bl.indiv <- as.data.frame(unique(bl$IndividualID))
colnames(bl.indiv) <- 'IndividualID'
carMiles0 <- sqldf ('SELECT IndividualID,sum([TripDisIncSW]) as [carMiles0] FROM bl WHERE [bl].[MainMode_B04ID] IN (3,4,5,12) GROUP BY IndividualID')
carMiles0 <- left_join(bl.indiv, carMiles0, by='IndividualID')
carMilesR0 <- sqldf ('SELECT IndividualID,0 as [carMilesR0] FROM bl GROUP BY IndividualID')
#carMilesR0 <- left_join(bl.indiv, carMilesR0, by='IndividualID')
METh0 <-  sqldf ('SELECT IndividualID, sum(METh) AS METh0 FROM bl GROUP BY IndividualID')
TripTotalTime0 <- sqldf ('SELECT IndividualID, sum(TripTotalTime)AS TripTotalTime0 FROM bl GROUP BY IndividualID')
